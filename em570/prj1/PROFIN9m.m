clear all;close all;clc;#LOOP PARA ANALISARMOS UM DIFERENTE NÚMERO DE PONTOSfor np=10:20:100  % Dados  type='tri';      % tipo de aleta (piniforme('pin'), retangular('ret'), triangular('tri'))  a=0;             % posicao da base da aleta [m]  L=10;          % comprimento da aleta[m]   Ta=500;          % temperatura na base da aleta [K]  dTb=0;           % dT/dx em x=L em [K/m]  Tinf=293;        % temperatura do fluido de convecção [K]  H=(L-a)/(np-1);  % tamanho do intervalo entre os pontos de discretização  x=a:H:L;         % vetor com os pontos da discretização  h=15;                      % Coeficiente Convecção natural (ar) [W/(m^2*K)]  k=385;                     % Condutividade térmica (cobre) [W/(m*K)]  switch type        case 'pin' % aleta piniforme                     r0=0.005;        % raio da seção reta do final da aleta [m]           rx=-((2*r0)/L)*x + 3*r0;   % raio da area da seção reta em função de x           % Vetor com as áreas da seção reta em cada ponto                      Asr=pi*(rx.^2);                      % Vetor com a área da superfície em cada ponto                      Asup=((6*pi*r0+2*pi*rx)/2).*x;                      % Vetor com a derivada da área da seção reta em cada ponto                     dAsr=pi*((12*(r0^2))/L + (8*(r0^2).*x)/(L^2));                       % Vetor com a derivada da área da superficie em cada ponto                    dAsup=(3*pi*r0 + pi*((-4*r0.*x/L) + 3*r0)); % derivada da área da seção reta (constante)                              case 'tri' % aleta triangular                   Ha = 0.03;       % Altura inicial do triângulo           C = 0.03;        % Espessura da aleta           b=0.01;         % altura da seção reta do final da aleta [m]           rx=Ha + ((b - Ha)/L)*x;   % Altura do triangulo ao longo de x           % Vetor com as áreas da seção reta em cada ponto                     Asr= rx*C;           % Vetor com a área da superfície em cada ponto           Asup= 2*(rx.*(x/2)+(Ha*x/2)) + C*x + sqrt((((b-Ha)*x)/L).^2+(x.^2))*C ;                      % Vetor com a derivada da área da superfície em cada ponto           dAsup = 2*rx + C + (C*((2*(b-Ha)^2)*(x./L^2) + 2*x))./(2*sqrt(((b-Ha)*x./L).^2 + x.^2));                       dAsr= C*((b-Ha)/L)*ones(np,1); % derivada da área da seção reta (constante)                              case 'ret' % Aleta retangular                      C = 0.03; %Espessura da Aleta           Hr = 0.02;  %Altura da Aleta                       % Vetor com as áreas da seção reta em cada ponto           Asr= Hr*C*ones(1,np);           % Vetor com a área da superfície em cada ponto           Asup= 2*(x*Hr) + 2*(x*C);                      % Vetor com a derivada da área da superfície em cada ponto           dAsup = (2*Hr + 2*C)*ones(1,np);                       dAsr= zeros(1,np) ; % derivada da área da seção reta (constante)                              otherwise          warning([ 'Tipo de aleta >>> ' , type , ' <<< não implementada ! ! ! ' ]) % aviso para aleta nao especificada corretamente  end  % Vetor com o valor de R em cada ponto  R = dAsr./Asr';  % Vetor com o valor de W em cada ponto      W = (h*dAsup)./(Asr*k);  % Valores que multiplicam T(i-1), T(i) e T(i+1), respectivamente  k1=(2-(H*R));  k2=(-4-(2*(H^2)*W));  k3=(2+(H*R));  % Vetor com os valores do outro lado da equação em cada ponto  f= -2*(H^2)*W*Tinf;  ##for i=1:np  ##  f(i)=-2*(H^2)*W(i)*Tinf;  ##end  % Arranjo Matricial  % Pontos internos   K=zeros(np);  for i=2:np-1      K(i,i-1)=k1(i);      K(i,i)=k2(i);      K(i,i+1)=k3(i);  end  % Dirichlet em x=a  e Neumann x=b  freedofs=[2:np];  f(2)=f(2)-k1(2)*Ta;  K(np,np-1)=-1;  K(np,np)=1;  f(np)=h*dTb;  % resolvendo o sistema  T=K(freedofs,freedofs)\f(freedofs)';  % Montando o vetor solução  Th=[Ta ; T ];  legenda = [";np = " num2str(np) ";"];    % plotando o gráfico  plot(x,Th,legenda); grid on;  xlabel(' Posição x [m]');  ylabel(' Temperatura [K] ');  hold on  endforswitch type      case 'ret' % aleta retangular        % Solução analítica para o caso simples (retangular com Asr constante)        m=((2*h*(C+Hr))/(k*C*Hr))^0.5;        Tana=((cosh(m*(L-x)))/(cosh(m*L)))*(Ta-Tinf) + Tinf;                plot(x,Tana,";Analitico;"); grid on;end% Taxa de tranferencia de calor (Numérica)dTh=zeros(np,1);for i=2:np-1  dTh(i)=((Th(i+1)-Th(i-1))/(2*h));enddTh(1)=(Th(2)-Th(1))/h;dTh(np)=dTb;dTh=dTh*(-k);  figure(2);plot(x,dTh,'r'); grid on;xlabel(' Posição x [m]');ylabel(' Transferêcia de calor na aleta [W] ');